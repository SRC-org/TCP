<?xml version="1.0" encoding="UTF-8"?>
<microprocessor name="SRC-TCP [Module] Custom v1.4.0.0" width="2" length="2" id_counter="485" id_counter_node="36" sym6="4984" sym7="5144" sym8="6184" sym9="7880">
	<nodes>
		<n id="19" component_id="265">
			<node label="Hub slot/Main Input" type="5" description="Outputs information to Hub/Main"/>
		</n>
		<n id="34" component_id="378">
			<node label="Main Front" mode="1" type="5" description="Connects to Main Front in order to receive information from other cars">
				<position z="1"/>
			</node>
		</n>
		<n id="35" component_id="379">
			<node label="Main Rear" mode="1" type="5" description="Connects to Main Rear in order to receive information from other cars">
				<position x="1" z="1"/>
			</node>
		</n>
	</nodes>
	<group>
		<data>
			<inputs/>
			<outputs/>
		</data>
		<components>
			<c type="40">
				<object id="405" count="2" offset="20">
					<pos x="2.5" y="-0.5"/>
					<in1 component_id="406"/>
					<in2 component_id="451"/>
				</object>
			</c>
			<c type="55">
				<object id="406">
					<pos x="0.75" y="-0.25"/>
					<in1 component_id="407"/>
				</object>
			</c>
			<c type="56">
				<object id="407" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool

function onTick()
	enc(1,8,clamp(gN(1),0,255)) --encode target ID
	enc(9,8,clamp(gN(2),0,255)) --encode my ID
	enc(17,6,clamp(gN(3),0,63)) --encode target module ID
	enc(23,6,clamp(gN(4),0,63)) --encode packet number
end

function enc(c,b,n)
	for i=0,b-1 do
		n = math.floor(n)
		sB(c+i,n%2 == 1)
		n = n/2
	end
end
	
function clamp(v,x,y) return math.min(math.max(v,x),y) end">
					<pos x="-1" y="-0.5"/>
					<in1 component_id="410"/>
				</object>
			</c>
			<c type="56">
				<object id="410" script='gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
TmodID=3
CmodID=property.getNumber("Custom Module ID")
PacketNum=0
clock=0
function onTick()
	MyID=gN(3)
	Data=gN(4)
	TargetID=gN(5)
	
	if clock&gt;=11 and Data~=0 then
		clock=0
		
		sN(1,TargetID)
		sN(2,MyID)
		sN(3,TmodID)
		sN(4,PacketNum)
		sN(5,Data)
		sN(6,CmodID)
		
		PacketNum=PacketNum+1
		if PacketNum&gt;=64 then
			PacketNum=0
		end
		
		sB(1,true)
	else
		clock=math.min(clock+1,4)
		
		for i=1,6 do
			sN(i,0)
		end
		
		sB(1,false)
	end
end'>
					<pos x="-2.75" y="-0.5"/>
					<in1 component_id="415"/>
				</object>
			</c>
			<c type="40">
				<object id="415" count="2" offset="3">
					<pos x="-4.5" y="-0.75"/>
					<inc component_id="379"/>
					<in1/>
					<in2/>
				</object>
			</c>
			<c type="29">
				<object id="416">
					<pos x="-1" y="-1.75"/>
					<in1 component_id="410"/>
				</object>
			</c>
			<c type="44">
				<object id="418" l="Packet send" on="on" off="off">
					<pos x="0.75" y="-1.75"/>
					<in1 component_id="416"/>
				</object>
			</c>
			<c type="56">
				<object id="424" script='gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
TmodID=3
CmodID=property.getNumber("Custom Module ID")
DecBits={}
cache={}
function onTick()
	MyID=gN(3)
	for i=1,5 do
		if gN(19+i*2)~=0 then
			numberToBinary(gN(19+i*2))
			if (dec(1,8)==myID or dec(1,8)==0) and dec(17,6)==TmodID then
				numberToBinary(gN(20+i*2))
				if dec(1,16)==CmodID then
					cache[#cache+1]=gN(19+i*2)
					cache[#cache+1]=gN(20+i*2)
				end
			end
		end
	end
	if #cache&gt;=2 then
		sN(1,cache[1])
		sN(2,cache[2])
		for i=1,#cache-1 do
			cache[i]=cache[i+1]
		end
		table.remove(cache,#cache)
		table.remove(cache,#cache)
	end
end


function numberToBinary(num)
	num=(&apos;I&apos;):unpack((&apos;f&apos;):pack(num))
	for i=0,31 do
		DecBits[1+i]=(num&amp;(1&lt;&lt;i))~=0
	end
end
	
function dec(c,b)
	n = 0
	for i=1,b do
		n = n*2
		n = n+(DecBits[c+b-i] and 1 or 0)
	end
	return n
end'>
					<pos x="-4.5" y="-3.5"/>
					<in1 component_id="379"/>
				</object>
			</c>
			<c type="56">
				<object id="427" script='gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
TmodID=3
CmodID=property.getNumber("Custom Module ID")
DecBits={}
cache={}
function onTick()
	MyID=gN(3)
	for i=1,5 do
		if gN(19+i*2)~=0 then
			numberToBinary(gN(19+i*2))
			if (dec(1,8)==myID or dec(1,8)==0) and dec(17,6)==TmodID then
				numberToBinary(gN(20+i*2))
				if dec(1,16)==CmodID then
					cache[#cache+1]=gN(19+i*2)
					cache[#cache+1]=gN(20+i*2)
				end
			end
		end
	end
	if #cache&gt;=2 then
		sN(1,cache[1])
		sN(2,cache[2])
		for i=1,#cache-1 do
			cache[i]=cache[i+1]
		end
		table.remove(cache,#cache)
		table.remove(cache,#cache)
	end
end


function numberToBinary(num)
	num=(&apos;I&apos;):unpack((&apos;f&apos;):pack(num))
	for i=0,31 do
		DecBits[1+i]=(num&amp;(1&lt;&lt;i))~=0
	end
end
	
function dec(c,b)
	n = 0
	for i=1,b do
		n = n*2
		n = n+(DecBits[c+b-i] and 1 or 0)
	end
	return n
end'>
					<pos x="-4.5" y="-4.5"/>
					<in1 component_id="378"/>
				</object>
			</c>
			<c type="55">
				<object id="451">
					<pos x="0.75" y="-1"/>
					<in1 component_id="452"/>
				</object>
			</c>
			<c type="56">
				<object id="452" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool

function onTick()
	enc(1,16,clamp(gN(6),0,65536)) --encode target ID
	enc(17,16,clamp(gN(5),0,65536)) --encode my ID
end

function enc(c,b,n)
	for i=0,b-1 do
		n = math.floor(n)
		sB(c+i,n%2 == 1)
		n = n/2
	end
end
	
function clamp(v,x,y) return math.min(math.max(v,x),y) end">
					<pos x="-1" y="-1.25"/>
					<in1 component_id="410"/>
				</object>
			</c>
			<c type="34">
				<object id="453" n="Custom Module ID">
					<pos x="-2.75" y="0.25"/>
					<v text="3" value="3"/>
				</object>
			</c>
			<c type="54">
				<object id="458">
					<pos x="4.25" y="-3.25"/>
					<in1 component_id="476"/>
				</object>
			</c>
			<c type="56">
				<object id="459" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
function dec(c,b)
	n = 0
	for i=1,b do
		n = n*2
		n = n+(gB(c+b-i) and 1 or 0)
	end
	return n
end
function onTick()
	output.setNumber(1, dec(9,8))
	output.setNumber(2, dec(23,6))
end">
					<pos x="6" y="-3.5"/>
					<in1 component_id="458"/>
				</object>
			</c>
			<c type="31">
				<object id="462">
					<pos x="-2.75" y="-3.25"/>
					<in1 component_id="424"/>
				</object>
			</c>
			<c type="31">
				<object id="463" i="1">
					<pos x="-2.75" y="-3.5"/>
					<in1 component_id="424"/>
				</object>
			</c>
			<c type="31">
				<object id="464">
					<pos x="-2.75" y="-4.25"/>
					<in1 component_id="427"/>
				</object>
			</c>
			<c type="31">
				<object id="465" i="1">
					<pos x="-2.75" y="-4.5"/>
					<in1 component_id="427"/>
				</object>
			</c>
			<c type="54">
				<object id="469">
					<pos x="4.25" y="-4"/>
					<in1 component_id="477"/>
				</object>
			</c>
			<c type="56">
				<object id="470" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
function dec(c,b)
	n = 0
	for i=1,b do
		n = n*2
		n = n+(gB(c+b-i) and 1 or 0)
	end
	return n
end
function onTick()
	output.setNumber(1, dec(17,16))
end">
					<pos x="6" y="-4.25"/>
					<in1 component_id="469"/>
				</object>
			</c>
			<c type="40">
				<object id="473" count="4">
					<pos x="-1" y="-4.25"/>
					<in1 component_id="462"/>
					<in2 component_id="463"/>
					<in3 component_id="464"/>
					<in4 component_id="465"/>
				</object>
			</c>
			<c type="56">
				<object id="475" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
cache={}
function onTick()
	if gN(1)~=0 then
		cache[#cache+1]=gN(1)
		cache[#cache+1]=gN(2)
	end
	if gN(3)~=0 then
		cache[#cache+1]=gN(3)
		cache[#cache+1]=gN(4)
	end
	if #cache&gt;=2 then
		sN(1,cache[1])
		sN(2,cache[2])
		for i=1,#cache-1 do
			cache[i]=cache[i+1]
		end
		table.remove(cache,#cache)
		table.remove(cache,#cache)
	end
end">
					<pos x="0.75" y="-3.5"/>
					<in1 component_id="473"/>
				</object>
			</c>
			<c type="31">
				<object id="476">
					<pos x="2.5" y="-3.25"/>
					<in1 component_id="475"/>
				</object>
			</c>
			<c type="31">
				<object id="477" i="1">
					<pos x="2.5" y="-4"/>
					<in1 component_id="475"/>
				</object>
			</c>
			<c type="31">
				<object id="480">
					<pos x="7.75" y="-3.25"/>
					<in1 component_id="459"/>
				</object>
			</c>
			<c type="31">
				<object id="481" i="1">
					<pos x="7.75" y="-4"/>
					<in1 component_id="459"/>
				</object>
			</c>
			<c type="31">
				<object id="482">
					<pos x="7.75" y="-4.75"/>
					<in1 component_id="470"/>
				</object>
			</c>
			<c type="43">
				<object id="483" l="Last packet sender ID">
					<pos x="9.5" y="-3.5"/>
					<in1 component_id="480"/>
				</object>
			</c>
			<c type="43">
				<object id="484" l="Last packet Number">
					<pos x="9.5" y="-4.25"/>
					<in1 component_id="481"/>
				</object>
			</c>
			<c type="43">
				<object id="485" l="Last packet data">
					<pos x="9.5" y="-5"/>
					<in1 component_id="482"/>
				</object>
			</c>
		</components>
		<components_bridge>
			<c type="5">
				<object id="265">
					<pos x="4.25"/>
					<in1 component_id="405"/>
				</object>
			</c>
			<c type="4">
				<object id="378">
					<pos x="-6.25" y="-4.25"/>
				</object>
			</c>
			<c type="4">
				<object id="379">
					<pos x="-6.25" y="-0.25"/>
				</object>
			</c>
		</components_bridge>
		<groups/>
		<component_states>
			<c0 id="405" count="2" offset="20">
				<pos x="2.5" y="-0.5"/>
				<in1 component_id="406"/>
				<in2 component_id="451"/>
			</c0>
			<c1 id="406">
				<pos x="0.75" y="-0.25"/>
				<in1 component_id="407"/>
			</c1>
			<c2 id="407" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool

function onTick()
	enc(1,8,clamp(gN(1),0,255)) --encode target ID
	enc(9,8,clamp(gN(2),0,255)) --encode my ID
	enc(17,6,clamp(gN(3),0,63)) --encode target module ID
	enc(23,6,clamp(gN(4),0,63)) --encode packet number
end

function enc(c,b,n)
	for i=0,b-1 do
		n = math.floor(n)
		sB(c+i,n%2 == 1)
		n = n/2
	end
end
	
function clamp(v,x,y) return math.min(math.max(v,x),y) end">
				<pos x="-1" y="-0.5"/>
				<in1 component_id="410"/>
			</c2>
			<c3 id="410" script='gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
TmodID=3
CmodID=property.getNumber("Custom Module ID")
PacketNum=0
clock=0
function onTick()
	MyID=gN(3)
	Data=gN(4)
	TargetID=gN(5)
	
	if clock&gt;=11 and Data~=0 then
		clock=0
		
		sN(1,TargetID)
		sN(2,MyID)
		sN(3,TmodID)
		sN(4,PacketNum)
		sN(5,Data)
		sN(6,CmodID)
		
		PacketNum=PacketNum+1
		if PacketNum&gt;=64 then
			PacketNum=0
		end
		
		sB(1,true)
	else
		clock=math.min(clock+1,4)
		
		for i=1,6 do
			sN(i,0)
		end
		
		sB(1,false)
	end
end'>
				<pos x="-2.75" y="-0.5"/>
				<in1 component_id="415"/>
			</c3>
			<c4 id="415" count="2" offset="3">
				<pos x="-4.5" y="-0.75"/>
				<inc component_id="379"/>
				<in1/>
				<in2/>
			</c4>
			<c5 id="416">
				<pos x="-1" y="-1.75"/>
				<in1 component_id="410"/>
			</c5>
			<c6 id="418" l="Packet send" on="on" off="off">
				<pos x="0.75" y="-1.75"/>
				<in1 component_id="416"/>
			</c6>
			<c7 id="424" script='gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
TmodID=3
CmodID=property.getNumber("Custom Module ID")
DecBits={}
cache={}
function onTick()
	MyID=gN(3)
	for i=1,5 do
		if gN(19+i*2)~=0 then
			numberToBinary(gN(19+i*2))
			if (dec(1,8)==myID or dec(1,8)==0) and dec(17,6)==TmodID then
				numberToBinary(gN(20+i*2))
				if dec(1,16)==CmodID then
					cache[#cache+1]=gN(19+i*2)
					cache[#cache+1]=gN(20+i*2)
				end
			end
		end
	end
	if #cache&gt;=2 then
		sN(1,cache[1])
		sN(2,cache[2])
		for i=1,#cache-1 do
			cache[i]=cache[i+1]
		end
		table.remove(cache,#cache)
		table.remove(cache,#cache)
	end
end


function numberToBinary(num)
	num=(&apos;I&apos;):unpack((&apos;f&apos;):pack(num))
	for i=0,31 do
		DecBits[1+i]=(num&amp;(1&lt;&lt;i))~=0
	end
end
	
function dec(c,b)
	n = 0
	for i=1,b do
		n = n*2
		n = n+(DecBits[c+b-i] and 1 or 0)
	end
	return n
end'>
				<pos x="-4.5" y="-3.5"/>
				<in1 component_id="379"/>
			</c7>
			<c8 id="427" script='gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
TmodID=3
CmodID=property.getNumber("Custom Module ID")
DecBits={}
cache={}
function onTick()
	MyID=gN(3)
	for i=1,5 do
		if gN(19+i*2)~=0 then
			numberToBinary(gN(19+i*2))
			if (dec(1,8)==myID or dec(1,8)==0) and dec(17,6)==TmodID then
				numberToBinary(gN(20+i*2))
				if dec(1,16)==CmodID then
					cache[#cache+1]=gN(19+i*2)
					cache[#cache+1]=gN(20+i*2)
				end
			end
		end
	end
	if #cache&gt;=2 then
		sN(1,cache[1])
		sN(2,cache[2])
		for i=1,#cache-1 do
			cache[i]=cache[i+1]
		end
		table.remove(cache,#cache)
		table.remove(cache,#cache)
	end
end


function numberToBinary(num)
	num=(&apos;I&apos;):unpack((&apos;f&apos;):pack(num))
	for i=0,31 do
		DecBits[1+i]=(num&amp;(1&lt;&lt;i))~=0
	end
end
	
function dec(c,b)
	n = 0
	for i=1,b do
		n = n*2
		n = n+(DecBits[c+b-i] and 1 or 0)
	end
	return n
end'>
				<pos x="-4.5" y="-4.5"/>
				<in1 component_id="378"/>
			</c8>
			<c9 id="451">
				<pos x="0.75" y="-1"/>
				<in1 component_id="452"/>
			</c9>
			<c10 id="452" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool

function onTick()
	enc(1,16,clamp(gN(6),0,65536)) --encode target ID
	enc(17,16,clamp(gN(5),0,65536)) --encode my ID
end

function enc(c,b,n)
	for i=0,b-1 do
		n = math.floor(n)
		sB(c+i,n%2 == 1)
		n = n/2
	end
end
	
function clamp(v,x,y) return math.min(math.max(v,x),y) end">
				<pos x="-1" y="-1.25"/>
				<in1 component_id="410"/>
			</c10>
			<c11 id="453" n="Custom Module ID">
				<pos x="-2.75" y="0.25"/>
				<v text="3" value="3"/>
			</c11>
			<c12 id="458">
				<pos x="4.25" y="-3.25"/>
				<in1 component_id="476"/>
			</c12>
			<c13 id="459" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
function dec(c,b)
	n = 0
	for i=1,b do
		n = n*2
		n = n+(gB(c+b-i) and 1 or 0)
	end
	return n
end
function onTick()
	output.setNumber(1, dec(9,8))
	output.setNumber(2, dec(23,6))
end">
				<pos x="6" y="-3.5"/>
				<in1 component_id="458"/>
			</c13>
			<c14 id="462">
				<pos x="-2.75" y="-3.25"/>
				<in1 component_id="424"/>
			</c14>
			<c15 id="463" i="1">
				<pos x="-2.75" y="-3.5"/>
				<in1 component_id="424"/>
			</c15>
			<c16 id="464">
				<pos x="-2.75" y="-4.25"/>
				<in1 component_id="427"/>
			</c16>
			<c17 id="465" i="1">
				<pos x="-2.75" y="-4.5"/>
				<in1 component_id="427"/>
			</c17>
			<c18 id="469">
				<pos x="4.25" y="-4"/>
				<in1 component_id="477"/>
			</c18>
			<c19 id="470" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
function dec(c,b)
	n = 0
	for i=1,b do
		n = n*2
		n = n+(gB(c+b-i) and 1 or 0)
	end
	return n
end
function onTick()
	output.setNumber(1, dec(17,16))
end">
				<pos x="6" y="-4.25"/>
				<in1 component_id="469"/>
			</c19>
			<c20 id="473" count="4">
				<pos x="-1" y="-4.25"/>
				<in1 component_id="462"/>
				<in2 component_id="463"/>
				<in3 component_id="464"/>
				<in4 component_id="465"/>
			</c20>
			<c21 id="475" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
cache={}
function onTick()
	if gN(1)~=0 then
		cache[#cache+1]=gN(1)
		cache[#cache+1]=gN(2)
	end
	if gN(3)~=0 then
		cache[#cache+1]=gN(3)
		cache[#cache+1]=gN(4)
	end
	if #cache&gt;=2 then
		sN(1,cache[1])
		sN(2,cache[2])
		for i=1,#cache-1 do
			cache[i]=cache[i+1]
		end
		table.remove(cache,#cache)
		table.remove(cache,#cache)
	end
end">
				<pos x="0.75" y="-3.5"/>
				<in1 component_id="473"/>
			</c21>
			<c22 id="476">
				<pos x="2.5" y="-3.25"/>
				<in1 component_id="475"/>
			</c22>
			<c23 id="477" i="1">
				<pos x="2.5" y="-4"/>
				<in1 component_id="475"/>
			</c23>
			<c24 id="480">
				<pos x="7.75" y="-3.25"/>
				<in1 component_id="459"/>
			</c24>
			<c25 id="481" i="1">
				<pos x="7.75" y="-4"/>
				<in1 component_id="459"/>
			</c25>
			<c26 id="482">
				<pos x="7.75" y="-4.75"/>
				<in1 component_id="470"/>
			</c26>
			<c27 id="483" l="Last packet sender ID">
				<pos x="9.5" y="-3.5"/>
				<in1 component_id="480"/>
			</c27>
			<c28 id="484" l="Last packet Number">
				<pos x="9.5" y="-4.25"/>
				<in1 component_id="481"/>
			</c28>
			<c29 id="485" l="Last packet data">
				<pos x="9.5" y="-5"/>
				<in1 component_id="482"/>
			</c29>
		</component_states>
		<component_bridge_states>
			<c0 id="265">
				<pos x="4.25"/>
				<in1 component_id="405"/>
			</c0>
			<c1 id="378">
				<pos x="-6.25" y="-4.25"/>
			</c1>
			<c2 id="379">
				<pos x="-6.25" y="-0.25"/>
			</c2>
		</component_bridge_states>
		<group_states/>
	</group>
</microprocessor>

