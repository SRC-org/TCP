<?xml version="1.0" encoding="UTF-8"?>
<microprocessor name="SRC-TCP [System] Main Controller v1.4.0" description="The base for everything. Hubs or Modules can be connected to it." width="5" length="2" id_counter="1656" id_counter_node="22" sym6="4984" sym7="5144" sym8="6184" sym9="7880">
	<nodes>
		<n id="6" component_id="46">
			<node label="Front Coupler" mode="1" type="5" description="Connects to front coupler">
				<position x="1" z="1"/>
			</node>
		</n>
		<n id="7" component_id="48">
			<node label="Front Coupler" type="5" description="Connects to front coupler">
				<position z="1"/>
			</node>
		</n>
		<n id="8" component_id="49">
			<node label="Rear Coupler" mode="1" type="5" description="Connects to rear coupler">
				<position x="1"/>
			</node>
		</n>
		<n id="9" component_id="51">
			<node label="Rear Coupler" type="5" description="Connects to rear coupler"/>
		</n>
		<n id="12" component_id="59">
			<node label="Main Input" mode="1" type="5" description="Outputs information to Hub/Main">
				<position x="3"/>
			</node>
		</n>
		<n id="13" component_id="61">
			<node label="Main Front" type="5" description="Transmits information from car(s) in front">
				<position x="4" z="1"/>
			</node>
		</n>
		<n id="16" component_id="238">
			<node label="Main Rear" type="5" description="Transmits information from car(s) in rear">
				<position x="4"/>
			</node>
		</n>
		<n id="17" component_id="246">
			<node label="Main Both" type="5" description="Transmits information from master, whichever direction that may be // Channels: B1: I am master; B2: Master exists; B3: I am inv">
				<position x="3" z="1"/>
			</node>
		</n>
		<n id="21" component_id="1383">
			<node label="Cab" mode="1" type="5" description="Connects to cab or cab controller for master and direction handling // Channels: B1: Request Master (push); B2: Release Master (">
				<position x="2" z="1"/>
			</node>
		</n>
	</nodes>
	<group>
		<data>
			<inputs/>
			<outputs/>
		</data>
		<components>
			<c type="53">
				<object id="1522">
					<pos x="-9" y="3.75"/>
					<in1 component_id="1534"/>
					<in2 component_id="49"/>
					<in3 component_id="1527"/>
				</object>
			</c>
			<c type="53">
				<object id="1523">
					<pos x="-9" y="4.75"/>
					<in1 component_id="49"/>
					<in2 component_id="1534"/>
					<in3 component_id="1527"/>
				</object>
			</c>
			<c type="56">
				<object id="1524" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
MyTMASID=0
MainbusIn={}
ModulesIn={}
MainbusInB={}
ModulesInB={}
for i=1,32,1 do
MainbusIn[i],ModulesIn[i]=0,0
MainbusInB[i],ModulesInB[i]=false,false
end
function onTick()


	--setup inputs
	
	if gN(1)==-16032025 then
		for i=1,32,1 do
			ModulesIn[i]=gN(i)
			ModulesInB[i]=gB(i)
		end
	else
		for i=1,32,1 do
			MainbusIn[i]=gN(i)
			MainbusInB[i]=gB(i)
		end
	end
	

	ReqMaster=ModulesInB[1]
	DenyMaster=ModulesInB[2]
	RearCabMaster=ModulesInB[3]
	IamMaster=ModulesInB[4]
	
	MyID=ModulesIn[2]
	
	
	RearConnector_f2=MainbusIn[3]-MainbusIn[3]%4  --removes the first 2 bits
	TMAS_key_Rear=RearConnector_f2%8192
	RearConnectorID=RearConnector_f2-TMAS_key_Rear
	
	if MainbusIn[2] ~= 0 and TMAS_key_Rear==4200 then  --checks if rear is master

		if RearConnectorID==MyTMASID then
	
			Master_Has_Identical_OS=true
		
		else
	
			Master_Has_Identical_OS=false
		
		end
		
		Master_Key_Accepted=true
	
	else
	
	Master_Key_Accepted=false
	Master_Has_Identical_OS=false
		
	end
	
	if IamMaster then
		Master_Has_Identical_OS=true
	end	
	
	--setup outputs
	
	
	sN(1,MainbusIn[1]+1)
	
	if IamMaster then
		sN(2,MyID)
		if RearCabMaster then
			sN(3,MyTMASID+4202)
		else
			sN(3,MyTMASID+4201)
		end
	else
		sN(2,MainbusIn[2])
		if MainbusIn[3]==0 then
			sN(3,MyTMASID+4200)
		else
			sN(3,MainbusIn[3])
		end
	end
	
	sB(1,MainbusInB[1] or ModulesInB[1])
	sB(2,MainbusInB[2] or ModulesInB[2])
	
	
	for i=4,22,1 do
		if ModulesIn[3]%(2^(i+1))&gt;=2^i and Master_Has_Identical_OS then
				sN(i,ModulesIn[i])
		else
				sN(i,MainbusIn[i])
		end
	end
	for i=4,32,1 do
		sB(i,MainbusInB[i] or ModulesInB[i])
	end
	
end
">
					<pos x="-7.25" y="5"/>
					<in1 component_id="1523"/>
				</object>
			</c>
			<c type="56">
				<object id="1525" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
MyTMASID=0
MainbusIn={}
ModulesIn={}
MainbusInB={}
ModulesInB={}
for i=1,32,1 do
MainbusIn[i],ModulesIn[i]=0,0
MainbusInB[i],ModulesInB[i]=false,false
end
function onTick()


	--setup inputs
	
	if gN(1)==-16032025 then
		for i=1,32,1 do
			ModulesIn[i]=gN(i)
			ModulesInB[i]=gB(i)
		end
	else
		for i=1,32,1 do
			MainbusIn[i]=gN(i)
			MainbusInB[i]=gB(i)
		end
	end
	

	ReqMaster=ModulesInB[1]
	DenyMaster=ModulesInB[2]
	RearCabMaster=ModulesInB[3]
	IamMaster=ModulesInB[4]
	
	MyID=ModulesIn[2]
	
	
	RearConnector_f2=MainbusIn[3]-MainbusIn[3]%4  --removes the first 2 bits
	TMAS_key_Rear=RearConnector_f2%8192
	RearConnectorID=RearConnector_f2-TMAS_key_Rear
	
	if MainbusIn[2] ~= 0 and TMAS_key_Rear==4200 then  --checks if rear is master

		if RearConnectorID==MyTMASID then
	
			Master_Has_Identical_OS=true
		
		else
	
			Master_Has_Identical_OS=false
		
		end
		
		Master_Key_Accepted=true
	
	else
	
	Master_Key_Accepted=false
	Master_Has_Identical_OS=false
		
	end
	
	if IamMaster then
		Master_Has_Identical_OS=true
	end	
	
	--setup outputs
	
	
	sN(1,MainbusIn[1]+1)
	
	if IamMaster then
		sN(2,MyID)
		if RearCabMaster then
			sN(3,MyTMASID+4202)
		else
			sN(3,MyTMASID+4201)
		end
	else
		sN(2,MainbusIn[2])
		if MainbusIn[3]==0 then
			sN(3,MyTMASID+4200)
		else
			sN(3,MainbusIn[3])
		end
	end
	
	sB(1,MainbusInB[1] or ModulesInB[1])
	sB(2,MainbusInB[2] or ModulesInB[2])
	
	
	for i=4,22,1 do
		if ModulesIn[3]%(2^(i+1))&gt;=2^i and Master_Has_Identical_OS then
				sN(i,ModulesIn[i])
		else
				sN(i,MainbusIn[i])
		end
	end
	for i=4,32,1 do
		sB(i,MainbusInB[i] or ModulesInB[i])
	end
	
end">
					<pos x="-7.25" y="4"/>
					<in1 component_id="1522"/>
				</object>
			</c>
			<c type="53">
				<object id="1526">
					<pos x="-5.5" y="4.75"/>
					<in1 component_id="1524"/>
					<in2 component_id="1525"/>
					<in3 component_id="1527"/>
				</object>
			</c>
			<c>
				<object id="1527">
					<pos x="-10.75" y="4.75"/>
					<in1 component_id="1527"/>
				</object>
			</c>
			<c type="53">
				<object id="1528">
					<pos x="-9" y="1.25"/>
					<in1 component_id="1534"/>
					<in2 component_id="46"/>
					<in3 component_id="1533"/>
				</object>
			</c>
			<c type="53">
				<object id="1529">
					<pos x="-9" y="2.25"/>
					<in1 component_id="46"/>
					<in2 component_id="1534"/>
					<in3 component_id="1533"/>
				</object>
			</c>
			<c type="56">
				<object id="1530" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
MyTMASID=0
MainbusIn={}
ModulesIn={}
MainbusInB={}
ModulesInB={}
for i=1,32,1 do
MainbusIn[i],ModulesIn[i]=0,0
MainbusInB[i],ModulesInB[i]=false,false
end
function onTick()


	--setup inputs
	
	if gN(1)==-16032025 then
		for i=1,32,1 do
			ModulesIn[i]=gN(i)
			ModulesInB[i]=gB(i)
		end
	else
		for i=1,32,1 do
			MainbusIn[i]=gN(i)
			MainbusInB[i]=gB(i)
		end
	end
	

	ReqMaster=ModulesInB[1]
	DenyMaster=ModulesInB[2]
	RearCabMaster=ModulesInB[3]
	IamMaster=ModulesInB[4]
	
	MyID=ModulesIn[2]
	
	
	FrontConnector_f2=MainbusIn[3]-MainbusIn[3]%4  --removes the first 2 bits
	TMAS_key_Front=FrontConnector_f2%8192
	FrontConnectorID=FrontConnector_f2-TMAS_key_Front
	
	if MainbusIn[2] ~= 0 and TMAS_key_Front==4200 then  --checks if rear is master

		if FrontConnectorID==MyTMASID then
	
			Master_Has_Identical_OS=true
		
		else
	
			Master_Has_Identical_OS=false
		
		end
		
		Master_Key_Accepted=true
	
	else
	
	Master_Key_Accepted=false
	Master_Has_Identical_OS=false
		
	end
	
	if IamMaster then
		Master_Has_Identical_OS=true
	end
	
	
	--setup outputs
	
	
	sN(1,MainbusIn[1]+1)
	
	if IamMaster then
		sN(2,MyID)
		if RearCabMaster then
			sN(3,MyTMASID+4201)
		else
			sN(3,MyTMASID+4202)
		end
	else
		sN(2,MainbusIn[2])
		if MainbusIn[3]==0 then
			sN(3,MyTMASID+4200)
		else
			sN(3,MainbusIn[3])
		end
	end
	
	sB(1,MainbusInB[1] or ModulesInB[1])
	sB(2,MainbusInB[2] or ModulesInB[2])
	
	
	for i=4,22,1 do
		if ModulesIn[3]%(2^(i+1))&gt;=2^i and Master_Has_Identical_OS then
				sN(i,ModulesIn[i])
		else
				sN(i,MainbusIn[i])
		end
	end
	for i=4,32,1 do
		sB(i,MainbusInB[i] or ModulesInB[i])
	end
	
end">
					<pos x="-7.25" y="2.5"/>
					<in1 component_id="1529"/>
				</object>
			</c>
			<c type="56">
				<object id="1531" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
MyTMASID=0
MainbusIn={}
ModulesIn={}
MainbusInB={}
ModulesInB={}
for i=1,32,1 do
MainbusIn[i],ModulesIn[i]=0,0
MainbusInB[i],ModulesInB[i]=false,false
end
function onTick()


	--setup inputs
	
	if gN(1)==-16032025 then
		for i=1,32,1 do
			ModulesIn[i]=gN(i)
			ModulesInB[i]=gB(i)
		end
	else
		for i=1,32,1 do
			MainbusIn[i]=gN(i)
			MainbusInB[i]=gB(i)
		end
	end
	

	ReqMaster=ModulesInB[1]
	DenyMaster=ModulesInB[2]
	RearCabMaster=ModulesInB[3]
	IamMaster=ModulesInB[4]
	
	MyID=ModulesIn[2]
	
	
	FrontConnector_f2=MainbusIn[3]-MainbusIn[3]%4  --removes the first 2 bits
	TMAS_key_Front=FrontConnector_f2%8192
	FrontConnectorID=FrontConnector_f2-TMAS_key_Front
	
	if MainbusIn[2] ~= 0 and TMAS_key_Front==4200 then  --checks if rear is master

		if FrontConnectorID==MyTMASID then
	
			Master_Has_Identical_OS=true
		
		else
	
			Master_Has_Identical_OS=false
		
		end
		
		Master_Key_Accepted=true
	
	else
	
	Master_Key_Accepted=false
	Master_Has_Identical_OS=false
		
	end
	
	if IamMaster then
		Master_Has_Identical_OS=true
	end	
	
	--setup outputs
	
	
	sN(1,MainbusIn[1]+1)
	
	if IamMaster then
		sN(2,MyID)
		if RearCabMaster then
			sN(3,MyTMASID+4201)
		else
			sN(3,MyTMASID+4202)
		end
	else
		sN(2,MainbusIn[2])
		if MainbusIn[3]==0 then
			sN(3,MyTMASID+4200)
		else
			sN(3,MainbusIn[3])
		end
	end
	
	sB(1,MainbusInB[1] or ModulesInB[1])
	sB(2,MainbusInB[2] or ModulesInB[2])
	
	
	for i=4,22,1 do
		if ModulesIn[3]%(2^(i+1))&gt;=2^i and Master_Has_Identical_OS then
				sN(i,ModulesIn[i])
		else
				sN(i,MainbusIn[i])
		end
	end
	for i=4,32,1 do
		sB(i,MainbusInB[i] or ModulesInB[i])
	end
	
end">
					<pos x="-7.25" y="1.5"/>
					<in1 component_id="1528"/>
				</object>
			</c>
			<c type="53">
				<object id="1532">
					<pos x="-5.5" y="2.25"/>
					<in1 component_id="1530"/>
					<in2 component_id="1531"/>
					<in3 component_id="1533"/>
				</object>
			</c>
			<c>
				<object id="1533">
					<pos x="-10.75" y="2.25"/>
					<in1 component_id="1533"/>
				</object>
			</c>
			<c type="41">
				<object id="1534" count="4">
					<pos x="-10.75" y="3.25"/>
					<inc component_id="1549"/>
					<in1 component_id="1608"/>
					<in2 component_id="1625"/>
					<in3 component_id="1544"/>
					<in4 component_id="1581"/>
				</object>
			</c>
			<c type="45">
				<object id="1536" e="x%4">
					<pos x="-24.75" y="10.75"/>
					<in1 component_id="1541"/>
				</object>
			</c>
			<c type="12">
				<object id="1537">
					<pos x="-23" y="10.75"/>
					<in1 component_id="1536"/>
					<min text="2" value="2"/>
					<max text="2" value="2"/>
				</object>
			</c>
			<c type="45">
				<object id="1538" e="x%4">
					<pos x="-24.75" y="10.25"/>
					<in1 component_id="1540"/>
				</object>
			</c>
			<c type="12">
				<object id="1539">
					<pos x="-23" y="10.25"/>
					<in1 component_id="1538"/>
					<min text="1" value="1"/>
					<max text="1" value="1"/>
				</object>
			</c>
			<c type="31">
				<object id="1540" i="2">
					<pos x="-26.5" y="10.25"/>
					<in1 component_id="46"/>
				</object>
			</c>
			<c type="31">
				<object id="1541" i="2">
					<pos x="-26.5" y="10.75"/>
					<in1 component_id="49"/>
				</object>
			</c>
			<c type="46">
				<object id="1543" e="(x|y)^(z&amp;w)">
					<pos x="-21.25" y="10"/>
					<in1 component_id="1537"/>
					<in2 component_id="1539"/>
					<in3 component_id="1544"/>
					<in4 component_id="1581"/>
				</object>
			</c>
			<c type="29">
				<object id="1544" i="4">
					<pos x="-23" y="9.75"/>
					<in1 component_id="1383"/>
				</object>
			</c>
			<c type="53">
				<object id="1546">
					<pos x="-19.5" y="10.75"/>
					<in1 component_id="49"/>
					<in2 component_id="46"/>
					<in3 component_id="1543"/>
				</object>
			</c>
			<c type="45">
				<object id="1547" e="x+1">
					<pos x="-16" y="11.25"/>
					<in1 component_id="1548"/>
				</object>
			</c>
			<c type="31">
				<object id="1548">
					<pos x="-17.75" y="11.25"/>
					<in1 component_id="1546"/>
				</object>
			</c>
			<c type="40">
				<object id="1549" count="2">
					<pos x="-12.5" y="3.75"/>
					<inc component_id="59"/>
					<in1 component_id="1602"/>
					<in2 component_id="1547"/>
				</object>
			</c>
			<c type="43">
				<object id="1550" l="My ID">
					<pos x="-14.25" y="11"/>
					<in1 component_id="1547"/>
				</object>
			</c>
			<c type="41">
				<object id="1551" count="3">
					<pos x="-17.75" y="-4.5"/>
					<inc component_id="1563"/>
					<in1 component_id="1581"/>
					<in2 component_id="1656"/>
					<in3 component_id="1543"/>
				</object>
			</c>
			<c type="40">
				<object id="1552" count="3">
					<pos x="-17.75" y="-5.75"/>
					<inc component_id="1551"/>
					<in1 component_id="1570"/>
					<in2 component_id="1574"/>
					<in3 component_id="1547"/>
				</object>
			</c>
			<c type="41">
				<object id="1553" count="3">
					<pos x="-17.75" y="-0.25"/>
					<inc component_id="1562"/>
					<in1 component_id="1581"/>
					<in2 component_id="1656"/>
					<in3 component_id="1543"/>
				</object>
			</c>
			<c type="40">
				<object id="1554" count="3">
					<pos x="-17.75" y="-1.5"/>
					<inc component_id="1553"/>
					<in1 component_id="1570"/>
					<in2 component_id="1574"/>
					<in3 component_id="1547"/>
				</object>
			</c>
			<c type="53">
				<object id="1555">
					<pos x="-14.25" y="-2.75"/>
					<in1 component_id="1554"/>
					<in2 component_id="1552"/>
					<in3 component_id="1557"/>
				</object>
			</c>
			<c type="42">
				<object id="1556">
					<pos x="-17.75" y="-3"/>
					<in1 component_id="1558"/>
					<e text="0.0001" value="0.0001"/>
				</object>
			</c>
			<c>
				<object id="1557">
					<pos x="-16" y="-2.75"/>
					<in1 component_id="1556"/>
				</object>
			</c>
			<c type="31">
				<object id="1558" i="1">
					<pos x="-19.5" y="-2.75"/>
					<in1 component_id="49"/>
				</object>
			</c>
			<c type="53">
				<object id="1559">
					<pos x="-12.5" y="-2.75"/>
					<in1 component_id="1561"/>
					<in2 component_id="1555"/>
					<in3 component_id="1581"/>
				</object>
			</c>
			<c type="40">
				<object id="1560" count="3">
					<pos x="-14.25" y="-1.5"/>
					<inc component_id="59"/>
					<in1 component_id="1570"/>
					<in2 component_id="1574"/>
					<in3 component_id="1547"/>
				</object>
			</c>
			<c type="41">
				<object id="1561" count="3">
					<pos x="-12.5" y="-1.5"/>
					<inc component_id="1560"/>
					<in1 component_id="1581"/>
					<in2 component_id="1656"/>
					<in3 component_id="1543"/>
				</object>
			</c>
			<c type="53">
				<object id="1562">
					<pos x="-19.5"/>
					<in1 component_id="49"/>
					<in2 component_id="1568"/>
					<in3 component_id="1601"/>
				</object>
			</c>
			<c type="53">
				<object id="1563">
					<pos x="-19.5" y="-4.25"/>
					<in1 component_id="46"/>
					<in2 component_id="1564"/>
					<in3 component_id="1601"/>
				</object>
			</c>
			<c type="40">
				<object id="1564" count="1" offset="4">
					<pos x="-21.25" y="-4.25"/>
					<in1 component_id="1565"/>
				</object>
			</c>
			<c type="31">
				<object id="1565" i="4">
					<pos x="-23" y="-4.25"/>
					<in1 component_id="1566"/>
				</object>
			</c>
			<c type="53">
				<object id="1566">
					<pos x="-24.75" y="-4.75"/>
					<in1 component_id="46"/>
					<in3 component_id="1593"/>
				</object>
			</c>
			<c type="53">
				<object id="1567">
					<pos x="-24.75" y="-0.5"/>
					<in1 component_id="49"/>
					<in3 component_id="1594"/>
				</object>
			</c>
			<c type="40">
				<object id="1568" count="1" offset="4">
					<pos x="-21.25"/>
					<in1 component_id="1569"/>
				</object>
			</c>
			<c type="31">
				<object id="1569" i="4">
					<pos x="-23"/>
					<in1 component_id="1567"/>
				</object>
			</c>
			<c type="10">
				<object id="1570" e="x+y+1">
					<pos x="-16" y="9.5"/>
					<in1 component_id="1575"/>
					<in2 component_id="1576"/>
				</object>
			</c>
			<c type="42">
				<object id="1571">
					<pos x="-19.5" y="8"/>
					<in1 component_id="1577"/>
					<e text="0.0001" value="0.0001"/>
				</object>
			</c>
			<c type="22">
				<object id="1573">
					<pos x="-17.75" y="8.25"/>
					<in1 component_id="1578"/>
					<in2 component_id="1577"/>
					<in3 component_id="1571"/>
				</object>
			</c>
			<c type="22">
				<object id="1574">
					<pos x="-16" y="8.25"/>
					<in1 component_id="1547"/>
					<in2 component_id="1573"/>
					<in3 component_id="1581"/>
				</object>
			</c>
			<c type="31">
				<object id="1575">
					<pos x="-17.75" y="10"/>
					<in1 component_id="49"/>
				</object>
			</c>
			<c type="31">
				<object id="1576">
					<pos x="-17.75" y="9.5"/>
					<in1 component_id="46"/>
				</object>
			</c>
			<c type="31">
				<object id="1577" i="1">
					<pos x="-21.25" y="8.75"/>
					<in1 component_id="49"/>
				</object>
			</c>
			<c type="31">
				<object id="1578" i="1">
					<pos x="-21.25" y="8.25"/>
					<in1 component_id="46"/>
				</object>
			</c>
			<c type="43">
				<object id="1579" l="Train Length">
					<pos x="-14.25" y="9.75"/>
					<in1 component_id="1570"/>
				</object>
			</c>
			<c type="43">
				<object id="1580" l="Master ID">
					<pos x="-14.25" y="8.5"/>
					<in1 component_id="1574"/>
				</object>
			</c>
			<c type="24">
				<object id="1581">
					<pos x="5" y="11"/>
					<in1 component_id="1612"/>
					<in2 component_id="1618"/>
				</object>
			</c>
			<c type="42">
				<object id="1583">
					<pos x="-19.5" y="7.25"/>
					<in1 component_id="1578"/>
					<e text="0.0001" value="0.0001"/>
				</object>
			</c>
			<c type="46">
				<object id="1586" e="!x|!y">
					<pos x="-17.75" y="7"/>
					<in1 component_id="1571"/>
					<in2 component_id="1583"/>
				</object>
			</c>
			<c type="12">
				<object id="1587">
					<pos x="-28.25" y="-2"/>
					<in1 component_id="1588"/>
					<min text="4200" value="4200"/>
					<max text="4200" value="4200"/>
				</object>
			</c>
			<c type="45">
				<object id="1588" e="x%8192-x%4">
					<pos x="-28.25" y="-1.5"/>
					<in1 component_id="1541"/>
				</object>
			</c>
			<c type="12">
				<object id="1589">
					<pos x="-28.25" y="-4.75"/>
					<in1 component_id="1590"/>
					<min text="4200" value="4200"/>
					<max text="4200" value="4200"/>
				</object>
			</c>
			<c type="45">
				<object id="1590" e="x%8192-x%4">
					<pos x="-28.25" y="-4.25"/>
					<in1 component_id="1540"/>
				</object>
			</c>
			<c type="42">
				<object id="1591">
					<pos x="-28.25" y="-0.75"/>
					<in1 component_id="1577"/>
					<e text="0.0001" value="0.0001"/>
				</object>
			</c>
			<c type="42">
				<object id="1592">
					<pos x="-28.25" y="-3.5"/>
					<in1 component_id="1578"/>
					<e text="0.0001" value="0.0001"/>
				</object>
			</c>
			<c type="46">
				<object id="1593" e="!x&amp;y">
					<pos x="-26.5" y="-4"/>
					<in1 component_id="1592"/>
					<in2 component_id="1589"/>
				</object>
			</c>
			<c type="46">
				<object id="1594" e="!x&amp;y">
					<pos x="-26.5" y="-1.25"/>
					<in1 component_id="1591"/>
					<in2 component_id="1587"/>
				</object>
			</c>
			<c type="45">
				<object id="1596" e="floor(x/8192)">
					<pos x="-26.5" y="-1.75"/>
					<in1 component_id="1541"/>
				</object>
			</c>
			<c type="45">
				<object id="1597" e="floor(x/8192)">
					<pos x="-26.5" y="-2.25"/>
					<in1 component_id="1540"/>
				</object>
			</c>
			<c type="15">
				<object id="1598">
					<pos x="-26.5" y="-2.75"/>
					<n text="0"/>
				</object>
			</c>
			<c type="42">
				<object id="1599">
					<pos x="-24.75" y="-2"/>
					<in1 component_id="1596"/>
					<in2 component_id="1598"/>
					<e text="0.0001" value="0.0001"/>
				</object>
			</c>
			<c type="42">
				<object id="1600">
					<pos x="-24.75" y="-2.75"/>
					<in1 component_id="1597"/>
					<in2 component_id="1598"/>
					<e text="0.0001" value="0.0001"/>
				</object>
			</c>
			<c type="46">
				<object id="1601" e="(x&amp;y)|(z&amp;w)">
					<pos x="-23" y="-2.5"/>
					<in1 component_id="1599"/>
					<in2 component_id="1594"/>
					<in3 component_id="1593"/>
					<in4 component_id="1600"/>
				</object>
			</c>
			<c type="15">
				<object id="1602">
					<pos x="-14.25" y="3.75"/>
					<n text="-16032025" value="-16032025"/>
				</object>
			</c>
			<c type="29">
				<object id="1604">
					<pos x="-3.75" y="11.25"/>
					<in1 component_id="1383"/>
				</object>
			</c>
			<c type="29">
				<object id="1605" i="1">
					<pos x="-3.75" y="9.5"/>
					<in1 component_id="1383"/>
				</object>
			</c>
			<c type="29">
				<object id="1606" i="2">
					<pos x="-3.75" y="9"/>
					<in1 component_id="1383"/>
				</object>
			</c>
			<c type="29">
				<object id="1607" i="3">
					<pos x="-3.75" y="8.5"/>
					<in1 component_id="1383"/>
				</object>
			</c>
			<c type="48">
				<object id="1608">
					<pos x="-2" y="11.25"/>
					<in1 component_id="1604"/>
				</object>
			</c>
			<c type="26">
				<object id="1609" ct="0">
					<pos x="-0.25" y="11.25"/>
					<in1 component_id="1608"/>
				</object>
			</c>
			<c type="48">
				<object id="1611" m="0">
					<pos x="1.5" y="11.25"/>
					<in1 component_id="1609"/>
				</object>
			</c>
			<c type="46">
				<object id="1612" e="(x&amp;y&amp;!z)|(x&amp;w)">
					<pos x="3.25" y="10.5"/>
					<in1 component_id="1611"/>
					<in2 component_id="1613" node_index="1"/>
					<in3 component_id="1586"/>
					<in4 component_id="1606"/>
				</object>
			</c>
			<c type="24">
				<object id="1613">
					<pos x="1.5" y="10.5"/>
					<in1 component_id="1615"/>
					<in2 component_id="1608"/>
				</object>
			</c>
			<c type="2">
				<object id="1615">
					<pos x="-0.25" y="10.5"/>
					<in1 component_id="1616"/>
					<in2 component_id="1617"/>
				</object>
			</c>
			<c type="29">
				<object id="1616" i="1">
					<pos x="-2" y="10.75"/>
					<in1 component_id="49"/>
				</object>
			</c>
			<c type="29">
				<object id="1617" i="1">
					<pos x="-2" y="10.25"/>
					<in1 component_id="46"/>
				</object>
			</c>
			<c type="47">
				<object id="1618" e="w|(x&amp;(!b|(b&amp;!y)))|((c|d)&amp;!y)">
					<pos x="3.25" y="7.75"/>
					<in1 component_id="1605"/>
					<in2 component_id="1606"/>
					<in3 component_id="1607"/>
					<in4 component_id="1634"/>
					<in6 component_id="1632"/>
					<in7 component_id="1622"/>
					<in8 component_id="1623"/>
				</object>
			</c>
			<c type="1">
				<object id="1619">
					<pos x="-2" y="9"/>
					<in1 component_id="1581"/>
					<in2 component_id="1586"/>
				</object>
			</c>
			<c type="26">
				<object id="1620" dt="0">
					<pos x="-2" y="8.5"/>
					<in1 component_id="1619"/>
				</object>
			</c>
			<c type="29">
				<object id="1622">
					<pos x="1.5" y="7.5"/>
					<in1 component_id="49"/>
				</object>
			</c>
			<c type="29">
				<object id="1623">
					<pos x="1.5" y="7"/>
					<in1 component_id="46"/>
				</object>
			</c>
			<c type="46">
				<object id="1624" e="x&amp;(y|z)">
					<pos x="3.25" y="6.5"/>
					<in1 component_id="1606"/>
					<in2 component_id="1622"/>
					<in3 component_id="1623"/>
				</object>
			</c>
			<c type="48">
				<object id="1625">
					<pos x="5" y="7.25"/>
					<in1 component_id="1624"/>
				</object>
			</c>
			<c type="44">
				<object id="1626" l="I am master" on="yes" off="no">
					<pos x="5" y="10.5"/>
					<in1 component_id="1581"/>
				</object>
			</c>
			<c type="33">
				<object id="1632" n="Lock release on lock master" on="Locked" off="Unlocked">
					<pos x="1.5" y="8.25"/>
				</object>
			</c>
			<c type="47">
				<object id="1634" e="(x&amp;(!w&amp;!a))|(y&amp;!a)|z">
					<pos x="-0.25" y="7.5"/>
					<in1 component_id="1619"/>
					<in2 component_id="1620"/>
					<in3 component_id="1635"/>
					<in4 component_id="1606"/>
					<in5 component_id="1607"/>
				</object>
			</c>
			<c type="26">
				<object id="1635" dt="0">
					<pos x="-2" y="8"/>
					<in1 component_id="1620"/>
				</object>
			</c>
			<c type="2">
				<object id="1656">
					<pos x="-16" y="7.5"/>
					<in1 component_id="1586"/>
					<in2 component_id="1581"/>
				</object>
			</c>
		</components>
		<components_bridge>
			<c type="4">
				<object id="46">
					<pos x="-10.75" y="2.75"/>
				</object>
			</c>
			<c type="5">
				<object id="48">
					<pos x="-3.75" y="5.25"/>
					<in1 component_id="1526"/>
				</object>
			</c>
			<c type="4">
				<object id="49">
					<pos x="-10.75" y="5.25"/>
				</object>
			</c>
			<c type="5">
				<object id="51">
					<pos x="-3.75" y="2.75"/>
					<in1 component_id="1532"/>
				</object>
			</c>
			<c type="4">
				<object id="59">
					<pos x="-14.25" y="4.25"/>
				</object>
			</c>
			<c type="5">
				<object id="61">
					<pos x="-16" y="-5"/>
					<in1 component_id="1552"/>
				</object>
			</c>
			<c type="5">
				<object id="238">
					<pos x="-16" y="-0.75"/>
					<in1 component_id="1554"/>
				</object>
			</c>
			<c type="5">
				<object id="246">
					<pos x="-10.75" y="-2.25"/>
					<in1 component_id="1559"/>
				</object>
			</c>
			<c type="4">
				<object id="1383">
					<pos x="-24.75" y="9.75"/>
				</object>
			</c>
		</components_bridge>
		<groups/>
		<component_states>
			<c0 id="1522">
				<pos x="-9" y="3.75"/>
				<in1 component_id="1534"/>
				<in2 component_id="49"/>
				<in3 component_id="1527"/>
			</c0>
			<c1 id="1523">
				<pos x="-9" y="4.75"/>
				<in1 component_id="49"/>
				<in2 component_id="1534"/>
				<in3 component_id="1527"/>
			</c1>
			<c2 id="1524" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
MyTMASID=0
MainbusIn={}
ModulesIn={}
MainbusInB={}
ModulesInB={}
for i=1,32,1 do
MainbusIn[i],ModulesIn[i]=0,0
MainbusInB[i],ModulesInB[i]=false,false
end
function onTick()


	--setup inputs
	
	if gN(1)==-16032025 then
		for i=1,32,1 do
			ModulesIn[i]=gN(i)
			ModulesInB[i]=gB(i)
		end
	else
		for i=1,32,1 do
			MainbusIn[i]=gN(i)
			MainbusInB[i]=gB(i)
		end
	end
	

	ReqMaster=ModulesInB[1]
	DenyMaster=ModulesInB[2]
	RearCabMaster=ModulesInB[3]
	IamMaster=ModulesInB[4]
	
	MyID=ModulesIn[2]
	
	
	RearConnector_f2=MainbusIn[3]-MainbusIn[3]%4  --removes the first 2 bits
	TMAS_key_Rear=RearConnector_f2%8192
	RearConnectorID=RearConnector_f2-TMAS_key_Rear
	
	if MainbusIn[2] ~= 0 and TMAS_key_Rear==4200 then  --checks if rear is master

		if RearConnectorID==MyTMASID then
	
			Master_Has_Identical_OS=true
		
		else
	
			Master_Has_Identical_OS=false
		
		end
		
		Master_Key_Accepted=true
	
	else
	
	Master_Key_Accepted=false
	Master_Has_Identical_OS=false
		
	end
	
	if IamMaster then
		Master_Has_Identical_OS=true
	end	
	
	--setup outputs
	
	
	sN(1,MainbusIn[1]+1)
	
	if IamMaster then
		sN(2,MyID)
		if RearCabMaster then
			sN(3,MyTMASID+4202)
		else
			sN(3,MyTMASID+4201)
		end
	else
		sN(2,MainbusIn[2])
		if MainbusIn[3]==0 then
			sN(3,MyTMASID+4200)
		else
			sN(3,MainbusIn[3])
		end
	end
	
	sB(1,MainbusInB[1] or ModulesInB[1])
	sB(2,MainbusInB[2] or ModulesInB[2])
	
	
	for i=4,22,1 do
		if ModulesIn[3]%(2^(i+1))&gt;=2^i and Master_Has_Identical_OS then
				sN(i,ModulesIn[i])
		else
				sN(i,MainbusIn[i])
		end
	end
	for i=4,32,1 do
		sB(i,MainbusInB[i] or ModulesInB[i])
	end
	
end
">
				<pos x="-7.25" y="5"/>
				<in1 component_id="1523"/>
			</c2>
			<c3 id="1525" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
MyTMASID=0
MainbusIn={}
ModulesIn={}
MainbusInB={}
ModulesInB={}
for i=1,32,1 do
MainbusIn[i],ModulesIn[i]=0,0
MainbusInB[i],ModulesInB[i]=false,false
end
function onTick()


	--setup inputs
	
	if gN(1)==-16032025 then
		for i=1,32,1 do
			ModulesIn[i]=gN(i)
			ModulesInB[i]=gB(i)
		end
	else
		for i=1,32,1 do
			MainbusIn[i]=gN(i)
			MainbusInB[i]=gB(i)
		end
	end
	

	ReqMaster=ModulesInB[1]
	DenyMaster=ModulesInB[2]
	RearCabMaster=ModulesInB[3]
	IamMaster=ModulesInB[4]
	
	MyID=ModulesIn[2]
	
	
	RearConnector_f2=MainbusIn[3]-MainbusIn[3]%4  --removes the first 2 bits
	TMAS_key_Rear=RearConnector_f2%8192
	RearConnectorID=RearConnector_f2-TMAS_key_Rear
	
	if MainbusIn[2] ~= 0 and TMAS_key_Rear==4200 then  --checks if rear is master

		if RearConnectorID==MyTMASID then
	
			Master_Has_Identical_OS=true
		
		else
	
			Master_Has_Identical_OS=false
		
		end
		
		Master_Key_Accepted=true
	
	else
	
	Master_Key_Accepted=false
	Master_Has_Identical_OS=false
		
	end
	
	if IamMaster then
		Master_Has_Identical_OS=true
	end	
	
	--setup outputs
	
	
	sN(1,MainbusIn[1]+1)
	
	if IamMaster then
		sN(2,MyID)
		if RearCabMaster then
			sN(3,MyTMASID+4202)
		else
			sN(3,MyTMASID+4201)
		end
	else
		sN(2,MainbusIn[2])
		if MainbusIn[3]==0 then
			sN(3,MyTMASID+4200)
		else
			sN(3,MainbusIn[3])
		end
	end
	
	sB(1,MainbusInB[1] or ModulesInB[1])
	sB(2,MainbusInB[2] or ModulesInB[2])
	
	
	for i=4,22,1 do
		if ModulesIn[3]%(2^(i+1))&gt;=2^i and Master_Has_Identical_OS then
				sN(i,ModulesIn[i])
		else
				sN(i,MainbusIn[i])
		end
	end
	for i=4,32,1 do
		sB(i,MainbusInB[i] or ModulesInB[i])
	end
	
end">
				<pos x="-7.25" y="4"/>
				<in1 component_id="1522"/>
			</c3>
			<c4 id="1526">
				<pos x="-5.5" y="4.75"/>
				<in1 component_id="1524"/>
				<in2 component_id="1525"/>
				<in3 component_id="1527"/>
			</c4>
			<c5 id="1527">
				<pos x="-10.75" y="4.75"/>
				<in1 component_id="1527"/>
			</c5>
			<c6 id="1528">
				<pos x="-9" y="1.25"/>
				<in1 component_id="1534"/>
				<in2 component_id="46"/>
				<in3 component_id="1533"/>
			</c6>
			<c7 id="1529">
				<pos x="-9" y="2.25"/>
				<in1 component_id="46"/>
				<in2 component_id="1534"/>
				<in3 component_id="1533"/>
			</c7>
			<c8 id="1530" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
MyTMASID=0
MainbusIn={}
ModulesIn={}
MainbusInB={}
ModulesInB={}
for i=1,32,1 do
MainbusIn[i],ModulesIn[i]=0,0
MainbusInB[i],ModulesInB[i]=false,false
end
function onTick()


	--setup inputs
	
	if gN(1)==-16032025 then
		for i=1,32,1 do
			ModulesIn[i]=gN(i)
			ModulesInB[i]=gB(i)
		end
	else
		for i=1,32,1 do
			MainbusIn[i]=gN(i)
			MainbusInB[i]=gB(i)
		end
	end
	

	ReqMaster=ModulesInB[1]
	DenyMaster=ModulesInB[2]
	RearCabMaster=ModulesInB[3]
	IamMaster=ModulesInB[4]
	
	MyID=ModulesIn[2]
	
	
	FrontConnector_f2=MainbusIn[3]-MainbusIn[3]%4  --removes the first 2 bits
	TMAS_key_Front=FrontConnector_f2%8192
	FrontConnectorID=FrontConnector_f2-TMAS_key_Front
	
	if MainbusIn[2] ~= 0 and TMAS_key_Front==4200 then  --checks if rear is master

		if FrontConnectorID==MyTMASID then
	
			Master_Has_Identical_OS=true
		
		else
	
			Master_Has_Identical_OS=false
		
		end
		
		Master_Key_Accepted=true
	
	else
	
	Master_Key_Accepted=false
	Master_Has_Identical_OS=false
		
	end
	
	if IamMaster then
		Master_Has_Identical_OS=true
	end
	
	
	--setup outputs
	
	
	sN(1,MainbusIn[1]+1)
	
	if IamMaster then
		sN(2,MyID)
		if RearCabMaster then
			sN(3,MyTMASID+4201)
		else
			sN(3,MyTMASID+4202)
		end
	else
		sN(2,MainbusIn[2])
		if MainbusIn[3]==0 then
			sN(3,MyTMASID+4200)
		else
			sN(3,MainbusIn[3])
		end
	end
	
	sB(1,MainbusInB[1] or ModulesInB[1])
	sB(2,MainbusInB[2] or ModulesInB[2])
	
	
	for i=4,22,1 do
		if ModulesIn[3]%(2^(i+1))&gt;=2^i and Master_Has_Identical_OS then
				sN(i,ModulesIn[i])
		else
				sN(i,MainbusIn[i])
		end
	end
	for i=4,32,1 do
		sB(i,MainbusInB[i] or ModulesInB[i])
	end
	
end">
				<pos x="-7.25" y="2.5"/>
				<in1 component_id="1529"/>
			</c8>
			<c9 id="1531" script="gN,gB,sN,sB=input.getNumber,input.getBool,output.setNumber,output.setBool
MyTMASID=0
MainbusIn={}
ModulesIn={}
MainbusInB={}
ModulesInB={}
for i=1,32,1 do
MainbusIn[i],ModulesIn[i]=0,0
MainbusInB[i],ModulesInB[i]=false,false
end
function onTick()


	--setup inputs
	
	if gN(1)==-16032025 then
		for i=1,32,1 do
			ModulesIn[i]=gN(i)
			ModulesInB[i]=gB(i)
		end
	else
		for i=1,32,1 do
			MainbusIn[i]=gN(i)
			MainbusInB[i]=gB(i)
		end
	end
	

	ReqMaster=ModulesInB[1]
	DenyMaster=ModulesInB[2]
	RearCabMaster=ModulesInB[3]
	IamMaster=ModulesInB[4]
	
	MyID=ModulesIn[2]
	
	
	FrontConnector_f2=MainbusIn[3]-MainbusIn[3]%4  --removes the first 2 bits
	TMAS_key_Front=FrontConnector_f2%8192
	FrontConnectorID=FrontConnector_f2-TMAS_key_Front
	
	if MainbusIn[2] ~= 0 and TMAS_key_Front==4200 then  --checks if rear is master

		if FrontConnectorID==MyTMASID then
	
			Master_Has_Identical_OS=true
		
		else
	
			Master_Has_Identical_OS=false
		
		end
		
		Master_Key_Accepted=true
	
	else
	
	Master_Key_Accepted=false
	Master_Has_Identical_OS=false
		
	end
	
	if IamMaster then
		Master_Has_Identical_OS=true
	end	
	
	--setup outputs
	
	
	sN(1,MainbusIn[1]+1)
	
	if IamMaster then
		sN(2,MyID)
		if RearCabMaster then
			sN(3,MyTMASID+4201)
		else
			sN(3,MyTMASID+4202)
		end
	else
		sN(2,MainbusIn[2])
		if MainbusIn[3]==0 then
			sN(3,MyTMASID+4200)
		else
			sN(3,MainbusIn[3])
		end
	end
	
	sB(1,MainbusInB[1] or ModulesInB[1])
	sB(2,MainbusInB[2] or ModulesInB[2])
	
	
	for i=4,22,1 do
		if ModulesIn[3]%(2^(i+1))&gt;=2^i and Master_Has_Identical_OS then
				sN(i,ModulesIn[i])
		else
				sN(i,MainbusIn[i])
		end
	end
	for i=4,32,1 do
		sB(i,MainbusInB[i] or ModulesInB[i])
	end
	
end">
				<pos x="-7.25" y="1.5"/>
				<in1 component_id="1528"/>
			</c9>
			<c10 id="1532">
				<pos x="-5.5" y="2.25"/>
				<in1 component_id="1530"/>
				<in2 component_id="1531"/>
				<in3 component_id="1533"/>
			</c10>
			<c11 id="1533">
				<pos x="-10.75" y="2.25"/>
				<in1 component_id="1533"/>
			</c11>
			<c12 id="1534" count="4">
				<pos x="-10.75" y="3.25"/>
				<inc component_id="1549"/>
				<in1 component_id="1608"/>
				<in2 component_id="1625"/>
				<in3 component_id="1544"/>
				<in4 component_id="1581"/>
			</c12>
			<c13 id="1536" e="x%4">
				<pos x="-24.75" y="10.75"/>
				<in1 component_id="1541"/>
			</c13>
			<c14 id="1537">
				<pos x="-23" y="10.75"/>
				<in1 component_id="1536"/>
				<min text="2" value="2"/>
				<max text="2" value="2"/>
			</c14>
			<c15 id="1538" e="x%4">
				<pos x="-24.75" y="10.25"/>
				<in1 component_id="1540"/>
			</c15>
			<c16 id="1539">
				<pos x="-23" y="10.25"/>
				<in1 component_id="1538"/>
				<min text="1" value="1"/>
				<max text="1" value="1"/>
			</c16>
			<c17 id="1540" i="2">
				<pos x="-26.5" y="10.25"/>
				<in1 component_id="46"/>
			</c17>
			<c18 id="1541" i="2">
				<pos x="-26.5" y="10.75"/>
				<in1 component_id="49"/>
			</c18>
			<c19 id="1543" e="(x|y)^(z&amp;w)">
				<pos x="-21.25" y="10"/>
				<in1 component_id="1537"/>
				<in2 component_id="1539"/>
				<in3 component_id="1544"/>
				<in4 component_id="1581"/>
			</c19>
			<c20 id="1544" i="4">
				<pos x="-23" y="9.75"/>
				<in1 component_id="1383"/>
			</c20>
			<c21 id="1546">
				<pos x="-19.5" y="10.75"/>
				<in1 component_id="49"/>
				<in2 component_id="46"/>
				<in3 component_id="1543"/>
			</c21>
			<c22 id="1547" e="x+1">
				<pos x="-16" y="11.25"/>
				<in1 component_id="1548"/>
			</c22>
			<c23 id="1548">
				<pos x="-17.75" y="11.25"/>
				<in1 component_id="1546"/>
			</c23>
			<c24 id="1549" count="2">
				<pos x="-12.5" y="3.75"/>
				<inc component_id="59"/>
				<in1 component_id="1602"/>
				<in2 component_id="1547"/>
			</c24>
			<c25 id="1550" l="My ID">
				<pos x="-14.25" y="11"/>
				<in1 component_id="1547"/>
			</c25>
			<c26 id="1551" count="3">
				<pos x="-17.75" y="-4.5"/>
				<inc component_id="1563"/>
				<in1 component_id="1581"/>
				<in2 component_id="1656"/>
				<in3 component_id="1543"/>
			</c26>
			<c27 id="1552" count="3">
				<pos x="-17.75" y="-5.75"/>
				<inc component_id="1551"/>
				<in1 component_id="1570"/>
				<in2 component_id="1574"/>
				<in3 component_id="1547"/>
			</c27>
			<c28 id="1553" count="3">
				<pos x="-17.75" y="-0.25"/>
				<inc component_id="1562"/>
				<in1 component_id="1581"/>
				<in2 component_id="1656"/>
				<in3 component_id="1543"/>
			</c28>
			<c29 id="1554" count="3">
				<pos x="-17.75" y="-1.5"/>
				<inc component_id="1553"/>
				<in1 component_id="1570"/>
				<in2 component_id="1574"/>
				<in3 component_id="1547"/>
			</c29>
			<c30 id="1555">
				<pos x="-14.25" y="-2.75"/>
				<in1 component_id="1554"/>
				<in2 component_id="1552"/>
				<in3 component_id="1557"/>
			</c30>
			<c31 id="1556">
				<pos x="-17.75" y="-3"/>
				<in1 component_id="1558"/>
				<e text="0.0001" value="0.0001"/>
			</c31>
			<c32 id="1557">
				<pos x="-16" y="-2.75"/>
				<in1 component_id="1556"/>
			</c32>
			<c33 id="1558" i="1">
				<pos x="-19.5" y="-2.75"/>
				<in1 component_id="49"/>
			</c33>
			<c34 id="1559">
				<pos x="-12.5" y="-2.75"/>
				<in1 component_id="1561"/>
				<in2 component_id="1555"/>
				<in3 component_id="1581"/>
			</c34>
			<c35 id="1560" count="3">
				<pos x="-14.25" y="-1.5"/>
				<inc component_id="59"/>
				<in1 component_id="1570"/>
				<in2 component_id="1574"/>
				<in3 component_id="1547"/>
			</c35>
			<c36 id="1561" count="3">
				<pos x="-12.5" y="-1.5"/>
				<inc component_id="1560"/>
				<in1 component_id="1581"/>
				<in2 component_id="1656"/>
				<in3 component_id="1543"/>
			</c36>
			<c37 id="1562">
				<pos x="-19.5"/>
				<in1 component_id="49"/>
				<in2 component_id="1568"/>
				<in3 component_id="1601"/>
			</c37>
			<c38 id="1563">
				<pos x="-19.5" y="-4.25"/>
				<in1 component_id="46"/>
				<in2 component_id="1564"/>
				<in3 component_id="1601"/>
			</c38>
			<c39 id="1564" count="1" offset="4">
				<pos x="-21.25" y="-4.25"/>
				<in1 component_id="1565"/>
			</c39>
			<c40 id="1565" i="4">
				<pos x="-23" y="-4.25"/>
				<in1 component_id="1566"/>
			</c40>
			<c41 id="1566">
				<pos x="-24.75" y="-4.75"/>
				<in1 component_id="46"/>
				<in3 component_id="1593"/>
			</c41>
			<c42 id="1567">
				<pos x="-24.75" y="-0.5"/>
				<in1 component_id="49"/>
				<in3 component_id="1594"/>
			</c42>
			<c43 id="1568" count="1" offset="4">
				<pos x="-21.25"/>
				<in1 component_id="1569"/>
			</c43>
			<c44 id="1569" i="4">
				<pos x="-23"/>
				<in1 component_id="1567"/>
			</c44>
			<c45 id="1570" e="x+y+1">
				<pos x="-16" y="9.5"/>
				<in1 component_id="1575"/>
				<in2 component_id="1576"/>
			</c45>
			<c46 id="1571">
				<pos x="-19.5" y="8"/>
				<in1 component_id="1577"/>
				<e text="0.0001" value="0.0001"/>
			</c46>
			<c47 id="1573">
				<pos x="-17.75" y="8.25"/>
				<in1 component_id="1578"/>
				<in2 component_id="1577"/>
				<in3 component_id="1571"/>
			</c47>
			<c48 id="1574">
				<pos x="-16" y="8.25"/>
				<in1 component_id="1547"/>
				<in2 component_id="1573"/>
				<in3 component_id="1581"/>
			</c48>
			<c49 id="1575">
				<pos x="-17.75" y="10"/>
				<in1 component_id="49"/>
			</c49>
			<c50 id="1576">
				<pos x="-17.75" y="9.5"/>
				<in1 component_id="46"/>
			</c50>
			<c51 id="1577" i="1">
				<pos x="-21.25" y="8.75"/>
				<in1 component_id="49"/>
			</c51>
			<c52 id="1578" i="1">
				<pos x="-21.25" y="8.25"/>
				<in1 component_id="46"/>
			</c52>
			<c53 id="1579" l="Train Length">
				<pos x="-14.25" y="9.75"/>
				<in1 component_id="1570"/>
			</c53>
			<c54 id="1580" l="Master ID">
				<pos x="-14.25" y="8.5"/>
				<in1 component_id="1574"/>
			</c54>
			<c55 id="1581">
				<pos x="5" y="11"/>
				<in1 component_id="1612"/>
				<in2 component_id="1618"/>
			</c55>
			<c56 id="1583">
				<pos x="-19.5" y="7.25"/>
				<in1 component_id="1578"/>
				<e text="0.0001" value="0.0001"/>
			</c56>
			<c57 id="1586" e="!x|!y">
				<pos x="-17.75" y="7"/>
				<in1 component_id="1571"/>
				<in2 component_id="1583"/>
			</c57>
			<c58 id="1587">
				<pos x="-28.25" y="-2"/>
				<in1 component_id="1588"/>
				<min text="4200" value="4200"/>
				<max text="4200" value="4200"/>
			</c58>
			<c59 id="1588" e="x%8192-x%4">
				<pos x="-28.25" y="-1.5"/>
				<in1 component_id="1541"/>
			</c59>
			<c60 id="1589">
				<pos x="-28.25" y="-4.75"/>
				<in1 component_id="1590"/>
				<min text="4200" value="4200"/>
				<max text="4200" value="4200"/>
			</c60>
			<c61 id="1590" e="x%8192-x%4">
				<pos x="-28.25" y="-4.25"/>
				<in1 component_id="1540"/>
			</c61>
			<c62 id="1591">
				<pos x="-28.25" y="-0.75"/>
				<in1 component_id="1577"/>
				<e text="0.0001" value="0.0001"/>
			</c62>
			<c63 id="1592">
				<pos x="-28.25" y="-3.5"/>
				<in1 component_id="1578"/>
				<e text="0.0001" value="0.0001"/>
			</c63>
			<c64 id="1593" e="!x&amp;y">
				<pos x="-26.5" y="-4"/>
				<in1 component_id="1592"/>
				<in2 component_id="1589"/>
			</c64>
			<c65 id="1594" e="!x&amp;y">
				<pos x="-26.5" y="-1.25"/>
				<in1 component_id="1591"/>
				<in2 component_id="1587"/>
			</c65>
			<c66 id="1596" e="floor(x/8192)">
				<pos x="-26.5" y="-1.75"/>
				<in1 component_id="1541"/>
			</c66>
			<c67 id="1597" e="floor(x/8192)">
				<pos x="-26.5" y="-2.25"/>
				<in1 component_id="1540"/>
			</c67>
			<c68 id="1598">
				<pos x="-26.5" y="-2.75"/>
				<n text="0"/>
			</c68>
			<c69 id="1599">
				<pos x="-24.75" y="-2"/>
				<in1 component_id="1596"/>
				<in2 component_id="1598"/>
				<e text="0.0001" value="0.0001"/>
			</c69>
			<c70 id="1600">
				<pos x="-24.75" y="-2.75"/>
				<in1 component_id="1597"/>
				<in2 component_id="1598"/>
				<e text="0.0001" value="0.0001"/>
			</c70>
			<c71 id="1601" e="(x&amp;y)|(z&amp;w)">
				<pos x="-23" y="-2.5"/>
				<in1 component_id="1599"/>
				<in2 component_id="1594"/>
				<in3 component_id="1593"/>
				<in4 component_id="1600"/>
			</c71>
			<c72 id="1602">
				<pos x="-14.25" y="3.75"/>
				<n text="-16032025" value="-16032025"/>
			</c72>
			<c73 id="1604">
				<pos x="-3.75" y="11.25"/>
				<in1 component_id="1383"/>
			</c73>
			<c74 id="1605" i="1">
				<pos x="-3.75" y="9.5"/>
				<in1 component_id="1383"/>
			</c74>
			<c75 id="1606" i="2">
				<pos x="-3.75" y="9"/>
				<in1 component_id="1383"/>
			</c75>
			<c76 id="1607" i="3">
				<pos x="-3.75" y="8.5"/>
				<in1 component_id="1383"/>
			</c76>
			<c77 id="1608">
				<pos x="-2" y="11.25"/>
				<in1 component_id="1604"/>
			</c77>
			<c78 id="1609" ct="0">
				<pos x="-0.25" y="11.25"/>
				<in1 component_id="1608"/>
			</c78>
			<c79 id="1611" m="0">
				<pos x="1.5" y="11.25"/>
				<in1 component_id="1609"/>
			</c79>
			<c80 id="1612" e="(x&amp;y&amp;!z)|(x&amp;w)">
				<pos x="3.25" y="10.5"/>
				<in1 component_id="1611"/>
				<in2 component_id="1613" node_index="1"/>
				<in3 component_id="1586"/>
				<in4 component_id="1606"/>
			</c80>
			<c81 id="1613">
				<pos x="1.5" y="10.5"/>
				<in1 component_id="1615"/>
				<in2 component_id="1608"/>
			</c81>
			<c82 id="1615">
				<pos x="-0.25" y="10.5"/>
				<in1 component_id="1616"/>
				<in2 component_id="1617"/>
			</c82>
			<c83 id="1616" i="1">
				<pos x="-2" y="10.75"/>
				<in1 component_id="49"/>
			</c83>
			<c84 id="1617" i="1">
				<pos x="-2" y="10.25"/>
				<in1 component_id="46"/>
			</c84>
			<c85 id="1618" e="w|(x&amp;(!b|(b&amp;!y)))|((c|d)&amp;!y)">
				<pos x="3.25" y="7.75"/>
				<in1 component_id="1605"/>
				<in2 component_id="1606"/>
				<in3 component_id="1607"/>
				<in4 component_id="1634"/>
				<in6 component_id="1632"/>
				<in7 component_id="1622"/>
				<in8 component_id="1623"/>
			</c85>
			<c86 id="1619">
				<pos x="-2" y="9"/>
				<in1 component_id="1581"/>
				<in2 component_id="1586"/>
			</c86>
			<c87 id="1620" dt="0">
				<pos x="-2" y="8.5"/>
				<in1 component_id="1619"/>
			</c87>
			<c88 id="1622">
				<pos x="1.5" y="7.5"/>
				<in1 component_id="49"/>
			</c88>
			<c89 id="1623">
				<pos x="1.5" y="7"/>
				<in1 component_id="46"/>
			</c89>
			<c90 id="1624" e="x&amp;(y|z)">
				<pos x="3.25" y="6.5"/>
				<in1 component_id="1606"/>
				<in2 component_id="1622"/>
				<in3 component_id="1623"/>
			</c90>
			<c91 id="1625">
				<pos x="5" y="7.25"/>
				<in1 component_id="1624"/>
			</c91>
			<c92 id="1626" l="I am master" on="yes" off="no">
				<pos x="5" y="10.5"/>
				<in1 component_id="1581"/>
			</c92>
			<c93 id="1632" n="Lock release on lock master" on="Locked" off="Unlocked">
				<pos x="1.5" y="8.25"/>
			</c93>
			<c94 id="1634" e="(x&amp;(!w&amp;!a))|(y&amp;!a)|z">
				<pos x="-0.25" y="7.5"/>
				<in1 component_id="1619"/>
				<in2 component_id="1620"/>
				<in3 component_id="1635"/>
				<in4 component_id="1606"/>
				<in5 component_id="1607"/>
			</c94>
			<c95 id="1635" dt="0">
				<pos x="-2" y="8"/>
				<in1 component_id="1620"/>
			</c95>
			<c96 id="1656">
				<pos x="-16" y="7.5"/>
				<in1 component_id="1586"/>
				<in2 component_id="1581"/>
			</c96>
		</component_states>
		<component_bridge_states>
			<c0 id="46">
				<pos x="-10.75" y="2.75"/>
			</c0>
			<c1 id="48">
				<pos x="-3.75" y="5.25"/>
				<in1 component_id="1526"/>
			</c1>
			<c2 id="49">
				<pos x="-10.75" y="5.25"/>
			</c2>
			<c3 id="51">
				<pos x="-3.75" y="2.75"/>
				<in1 component_id="1532"/>
			</c3>
			<c4 id="59">
				<pos x="-14.25" y="4.25"/>
			</c4>
			<c5 id="61">
				<pos x="-16" y="-5"/>
				<in1 component_id="1552"/>
			</c5>
			<c6 id="238">
				<pos x="-16" y="-0.75"/>
				<in1 component_id="1554"/>
			</c6>
			<c7 id="246">
				<pos x="-10.75" y="-2.25"/>
				<in1 component_id="1559"/>
			</c7>
			<c8 id="1383">
				<pos x="-24.75" y="9.75"/>
			</c8>
		</component_bridge_states>
		<group_states/>
	</group>
</microprocessor>

